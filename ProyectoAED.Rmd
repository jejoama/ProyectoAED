---
title: Evolución de la actividad, ocupación para grupos de edad mayores de 16 años
author:
  - name: Jeremy Joel Aguilar Marin
  - name: Jose Aguilar Milla
  - name: Javier Herrero Pérez

journal: notspecified 
type: article
status: submit
# front matter
simplesummary: |
  A Simple summary goes here.
abstract: |


keywords: |
  keyword 1; keyword 2; keyword 3 (list three to ten pertinent keywords specific 
  to the article, yet reasonably common within the subject discipline.).
# back matter

bibliography: mybibfile.bib
endnotes: false
output: 
  rticles::mdpi_article:
    extra_dependencies: longtable

---


```{r,echo = FALSE}
rm(list=ls())
```

# Introducción
Este artículo presenta un enfoque en R para el Análisis Exploratorio de Datos de la Encuesta de Población Activa (EPA), centrándose en la evolución histórica de la brecha de género en el mercado laboral español. Utilizando el ecosistema `tidyverse`, el estudio comienza con una limpieza y transformación de los datos empleando `dplyr` y el cálculo de Tasa de paro, actividad y ocupación, claves para el análisis. Seguido de la visualización con `ggplot2` para ilustrar la evolución temporal. Por último, se validan los resultados con pruebas de *t Student* para confirmar la significancia estadística de los resutlados.

## Carga de Librerías

```{r,echo = FALSE}
# Manejo de datos
library(readr)
library(dplyr)
library(tidyr)
library(stringr)
library(forcats)

# Visualización
library(ggplot2)
library(visdat)
library(treemapify)
library(gganimate)
library(gifski)
```

# Exploración inicial

## Importación y verificación inicial

- **Codificación e importación**: Se verifica la codificación y se importa el archivo CSV delimitado por tabulaciones, se indica que el separador decimal es la coma y que los valores *NA* están codificados como `".."`

```{r,echo = FALSE}
archivo<-"data/65948.csv"
guess_encoding(archivo)
```

```{r,echo = FALSE}
df<-read_delim(archivo, delim = "\t", escape_double = FALSE, na = "..", 
               trim_ws = TRUE,locale = locale(decimal_mark = ","))
```

```{r,echo = FALSE}
head(df)
```


Se comprueba la estructura inicial de los datos

```{r,echo = FALSE}
str(df)
```

## Valores faltantes

Con el objetivo de ver la cantidad de los datos faltantes la variable que tiene estos datos se utiliza la siguiente función: 

```{r,echo = FALSE}
vis_miss(df %>% rename(Situacion_Laboral = "Relación con la actividad económica"))+theme(
    axis.text.x = element_text(hjust = 1.2), 
    plot.margin = unit(c(1, 1, 1, 1), "cm") 
  )
```

```{r,echo = FALSE}
sapply(df,function(x) sum(is.na(x)))
```

Todos los valores ausentes se encuentran en `Total`

```{r,echo = FALSE}
df %>% rename(Situacion_Laboral = "Relación con la actividad económica") %>% filter(is.na(Total)) %>% ggplot(aes(x=Situacion_Laboral))+geom_bar(aes(fill=Edad))+labs(
    title = "Frecuencia de los registros faltantes NA",
    subtitle = "Distribución por Situación Laboral y la edad",
    y = "Valores faltantes", # Quitamos la etiqueta redundante del eje Y
    x = "Número de Registros con NA"
  ) +
  theme_minimal()
```

Se observa que los valores faltantes vienen asociados a grupos de edad altos y cuya relación con la actividad económica es "Parados que buscan primer empleo" o "Parados".


# Definición de variables

El valor de la columna **Total** viene definido con la siguiente expresión:

$$\text{Total}=\text{Activos}+\text{Inactivos}$$
Y los **Activos** se dividen en Ocupados y Parados:

$$\text{Activos}=\text{Ocupados}+\text{Parados}$$
## Fórmulas para el análisis (Tasas)

Las tasas permiten normalizar los datos y son la base para el análisis de brechas y series temporales:



La **tasa de paro** mide la proporción de la población activa que está desempleada:

$$\text{Tasa de paro}=\frac{\text{Parados}}{\text{Activos}} \cdot 100$$

La **tasa de actividad** mide la participación de una población en el mercado laboral:

$$\text{Tasa de actividad}=\frac{\text{Activos}}{\text{Total}} \cdot 100$$
La **tasa de ocupación** muestra qué parte de la población total de referencia tiene un empleo:

$$\text{Tasa de ocupación}=\frac{\text{Ocupados}}{\text{Total}} \cdot 100$$

# Limpieza

- **Renombrar columnas**: Utilizando `rename()` para acortar `"Relación con la actividad económica"` por ` "Situacion_Laboral"` para simplificar el manejo de columnas.

- **Filtrado de doble conteo**: Se eliminan las instancias donde las variables representan la suma de otras instancias (`Sexo="Ambos sexos"` y `Edad="Total"`) para evitar doble conteo y así verificar que cada registro sea una observación única.

- **Se aplica `pivot_wider()`** utilizando los valores de la columna `Situacion_Laboral` para crear las nuevas columnas (`names_from`) y los valores numéricos de la columna `Total`.

- **Renombrar variables**: Se renombra la columna `"parados que buscan primer empleo"` a un formato más corto `r "Parados_sin_exp"`

- **Imputación de NA a 0**: Los valores faltantes se concentran en categorías como Personas mayores de 65 en paro o que buscan su primer empleo. El INE suprime el dato por ser un valor insignificante, por lo que se opta por remplazar los valores nulos a 0 para no perder el resto de información válida de la instancia.

- **Creación de tasas**: Se añaden las columnas `Tasa_paro`, `Tasa_actividad` y `Tasa_ocupacion` utilizando `mutate()` y las expresiones de la EPA.

- **Ordenación en factores**: Se ordena la columna `Edad` como un factor ordinal y la columna `Sexo` como factor nominal.

```{r,echo = FALSE}
df_clean<-df %>% 
  rename(Situacion_Laboral = "Relación con la actividad económica") %>% 
  filter(Sexo != "Ambos sexos", Edad != "Total") %>% 
  mutate(Sexo=as.factor(Sexo), Edad=as.factor(Edad),
         Situacion_Laboral=as.factor(Situacion_Laboral)) %>%
  pivot_wider(names_from = Situacion_Laboral,values_from = Total) %>% 
  rename(Parados_sin_exp="Parados que buscan primer empleo") %>% 
  mutate(across(.cols=c(Parados,Parados_sin_exp,Activos,Ocupados,Inactivos),
                .fns=~replace_na(.,0))) %>% 
  mutate(across(c(Activos, Ocupados, Parados, Inactivos, Total), as.numeric),Tasa_paro=Parados/Activos*100,Tasa_actividad=Activos/Total*100,
         Tasa_ocupacion=Ocupados/Total*100) %>% 
  mutate(
    Edad = str_replace(Edad, "De ", ""),
    Edad = str_replace(Edad, " a ", "-"),
    Edad = str_replace(Edad, " años", ""),
    Edad = str_replace(Edad, "70 y más", "70+"),
    
    Edad = factor(Edad, levels = c(
      "16-19", "20-24", "25-29", "30-34", "35-39", 
      "40-44", "45-49", "50-54", "55-59", "60-64", 
      "65-69", "70+"), ordered = T
      )
  )
```


Se comprueba que la limpieza esté bien hecha, primero viendo si el formato de los datos es el adecuado y asegurando que no quedan valores faltantes.
```{r,  tidy=TRUE, results='markup',,echo = FALSE}
str(df_clean)
```

```{r,echo = FALSE}
sapply(df_clean,function(x) sum(is.na(x)))
```


```{r,echo = FALSE}
write_csv(df_clean,file = "data/df_clean.csv")
```

# Evolución temporal de las tasas con la brecha

##Evolucion de la tasa de paro por género y evolución de la brecha de la tasa de paro por género

En este bloque de código se construyen varias representaciones gráficas con el fin de analizar la evolución de la tasa de paro y la brecha de género a lo largo del tiempo. Para ello, se parte de una tabla en la que se calcula la variable *brecha_paro*, definida como la diferencia entre la tasa de paro de mujeres y la de hombres. Posteriormente, los datos se agrupan por periodo para obtener las tasas medias anuales de paro por sexo y la brecha media correspondiente. 

```{r}
library(dplyr)
library(tidyr)
library(ggplot2)

# 1º crear una tabla con la variable brecha_paro 
brecha <- datos %>% 
  select(Periodo, Edad,Sexo,Tasa_paro) %>% 
  pivot_wider(names_from = Sexo, values_from = Tasa_paro) %>% 
  mutate(brecha_paro=Mujeres-Hombres)
brecha

#2º Agrupar esas fechas por periodo, para asi no diferenciar entre grupos de edades y tener la brecha total
brechas_total <- brecha %>%
  group_by(Periodo) %>%
  summarise(
    tasa_hombres = mean(Hombres, na.rm = TRUE),
    tasa_mujeres = mean(Mujeres, na.rm = TRUE),
    brecha_paro_total = mean(brecha_paro, na.rm = TRUE)
  )
brechas_total

evo_brecha_total <- ggplot(brechas_total,aes(x=Periodo,y=brecha_paro_total)) + geom_line()+geom_point()+labs(title = "Evolución de la brecha de paro total",x="años",y="Brecha de tasa de paro")
evo_brecha_total
evo_tasa_total <-  ggplot(brechas_total, aes(x = Periodo)) +geom_line(aes(y = tasa_hombres, color = "Hombres")) +geom_point(aes(y = tasa_hombres, color = "Hombres")) +geom_line(aes(y = tasa_mujeres, color = "Mujeres")) +geom_point(aes(y = tasa_mujeres, color = "Mujeres")) +labs(title = "Evolución de la tasa de paro total por sexo",x = "Año",y = "Tasa de paro (%)",color = "Sexo")
evo_tasa_total

evo_tasa_y_brecha<-ggplot(brechas_total, aes(x = Periodo)) +geom_line(aes(y = tasa_hombres, color = "Hombres"), size = 1.3) +geom_point(aes(y = tasa_hombres, color = "Hombres"), size = 2) +geom_line(aes(y = tasa_mujeres, color = "Mujeres"), size = 1.3) +geom_point(aes(y = tasa_mujeres, color = "Mujeres"), size = 2) +geom_line(aes(y = brecha_paro_total, color = "Brecha"), size = 1.2,) +geom_point(aes(y = brecha_paro_total, color = "Brecha"), size = 2) +labs(title = "Evolución de la tasa de paro total por sexo y brecha",x = "Año",y = "Tasa de paro (%)",) +scale_color_manual(values = c("Hombres" = "blue", "Mujeres" = "red", "Brecha" = "black"))+theme_minimal()
evo_tasa_y_brecha
```
El primer gráfico (`evo_brecha_total`) representa la evolución de la brecha de paro total tanto con lineas como con puntos para mostrar la tendencia y los valores anuales. En él se observa cómo la diferencia entre hombres y mujeres en la tasa de paro varía a lo largo del tiempo, con un aumento notable en los años posteriores a la crisis de 2008 y una ligera reducción en la última etapa analizada. Por su parte, el segundo gráfico (`evo_tasa_total`) muestra la evolución de la tasa de paro de hombres y mujeres de forma independiente, utilizando colores diferenciados para cada grupo. Esta visualización permite comparar directamente la evolución de ambos sexos, destacando la persistencia de una mayor tasa de paro entre las mujeres en prácticamente todos los años del periodo estudiado.

Por último, el tercer gráfico (`evo_tasa_y_brecha`) combina ambas perspectivas en una única figura. Se incluyen las líneas de hombres, mujeres y brecha, diferenciadas mediante colores específicos definidos con `scale_color_manual()`. Este enfoque conjunto facilita observar la relación entre las dos tasas y su diferencia a lo largo del tiempo, ofreciendo una visión global de la evolución de las desigualdades de género en el desempleo. En conjunto, el código y las representaciones resultantes permiten analizar de forma visual y comparativa la magnitud y la persistencia de la brecha de género en el mercado laboral español.

## Evolucion de la tasa de paro y su brecha por grupo de edad
En este bloque de código se elaboran una serie de gráficos exploratorios con el objetivo de analizar la evolución de la brecha de paro entre mujeres y hombres desagregada por grupos de edad. A partir del conjunto de datos principal, se construye una tabla denominada brecha_edades que contiene la tasa de paro por sexo y edad, y se calcula la variable brecha_paro como la diferencia entre las tasas de mujeres y hombres. Posteriormente, los grupos de edad se clasifican en intervalos de diez años, y los datos se dividen en distintos subconjuntos (df_1, df_2, df_3) para facilitar la representación y mejorar la legibilidad de los gráficos.

```{r}
brecha_edades <- datos %>% 
  select(Sexo, Edad, Periodo,Tasa_paro) %>% 
  pivot_wider(names_from = Sexo, values_from = Tasa_paro) %>% 
  mutate(brecha_paro=Mujeres-Hombres)
brecha_edades

unique(brecha_edades$Edad)
library(ggplot2)
#Para hacerlo con un unico dataframe, es muy complejo de graficar, asi que es mejor dividirlo en varios dataframes, para que así sea mas sencillo trabajar
edades_1 <- c("De 16 a 19 años", "De 20 a 24 años", "De 25 a 29 años", "De 30 a 34 años")
edades_2 <- c("De 35 a 39 años", "De 40 a 44 años", "De 45 a 49 años", "De 50 a 54 años")
edades_3 <- c("De 55 a 59 años", "De 60 a 64 años", "De 65 a 69 años", "De 70 y más años")

df_1 <- brecha_edades %>% filter(Edad %in% edades_1)
df_2 <- brecha_edades %>% filter(Edad %in% edades_2)
df_3 <- brecha_edades %>%  filter(Edad %in% edades_3)

ggplot(df_1, aes(x = Periodo, y = brecha_paro)) +
  geom_line( size = 1.2) +
  geom_point(size = 2) +
  facet_wrap(~ Edad, ncol = 2) +  # ← cuadrícula 2×2
  labs(title = "Evolución de la brecha de paro (Mujeres - Hombres)",x = "Año",y = "Brecha") +
  theme_minimal()

ggplot(df_2, aes(x = Periodo, y = brecha_paro)) +
  geom_line( size = 1.2) +
  geom_point(size = 2) +
  facet_wrap(~ Edad, ncol = 2) +  
  labs(title = "Evolución de la brecha de paro (Mujeres - Hombres)",x = "Año",y = "Brecha") +
  theme_minimal()

ggplot(df_3, aes(x = Periodo, y = brecha_paro)) +
  geom_line( size = 1.2) +
  geom_point(size = 2) +
  facet_wrap(~ Edad, ncol = 2) +  
  labs(title = "Evolución de la brecha de paro (Mujeres - Hombres)",x = "Año",y = "Brecha") +
  theme_minimal()

colores_vivos <- c(
  "#FF4B00", "#00FFFF", "#FFD300", "#FF1493",
  "#00FF00", "#1E90FF", "#FF7F50", "#ADFF2F",
  "#DA70D6", "#FF4500", "#00CED1", "#FFFF66"
)
ggplot(brecha_edades, aes(x = Periodo, y = brecha_paro,colour = Edad)) +
  geom_line( size = 0.5) +
  geom_point()  +
  labs(title = "Evolución de la brecha de paro (Mujeres - Hombres)",x = "Año",y = "Brecha") +
  theme_minimal()
```
Los primeros gráficos utilizan facet_wrap() para mostrar la evolución temporal de la brecha de paro dentro de cada grupo de edad. Cada panel representa un intervalo etario y permite observar cómo la diferencia entre hombres y mujeres ha variado a lo largo del tiempo. Estas visualizaciones, evidencian que la brecha no se comporta de manera homogénea entre generaciones: mientras que en los grupos más jóvenes las diferencias tienden a fluctuar con mayor intensidad, en los grupos intermedios y de mayor edad la brecha presenta una evolución más estable, aunque persiste una desigualdad estructural en la mayoría de los casos.

Por último, se incluye una representación global en la que se superponen todas las series de edad en un mismo gráfico, utilizando una paleta de colores vivos definida manualmente. Este gráfico tiene un carácter eminentemente exploratorio y permite comparar visualmente la magnitud y la variabilidad de la brecha de paro entre cohortes. En conjunto, este bloque de código contribuye a profundizar en el análisis intergeneracional de la desigualdad laboral, revelando que las diferencias por género en el desempleo no afectan por igual a todos los grupos de edad y que ciertos tramos, especialmente los más jóvenes, muestran una mayor volatilidad a lo largo del tiempo.


## Gráfica de Barras comparación grupos de edades con mayor brecha en 2006 y en 2024

En este bloque de código se elaboran una serie de gráficos exploratorios de barras destinados a analizar la evolución de la brecha de paro por grupos de edad a lo largo del tiempo. Para ello, a partir del conjunto brecha_edades, que contiene la diferencia entre las tasas de paro femeninas y masculinas, se genera un conjunto de gráficos individuales por año mediante la función lapply(). En cada uno de ellos, las barras representan la magnitud de la brecha en los distintos grupos de edad, mientras que la línea discontinua negra indica la media general de la brecha para ese año. De esta forma, el código permite observar en paralelo la estructura intergeneracional de las desigualdades laborales y cómo varía la media de brecha entre periodos.

```{r}

a1<- brecha_edades %>% filter(Periodo %in% 2024)

library(ggplot2)
library(dplyr)

rango_y <- range(brecha_edades$brecha_paro)
años<- unique(datos$Periodo)


grafico_brecha_paro_por_año<-lapply(años, function(año){
  brecha_edades %>% 
    filter(Periodo==año) %>% 
    ggplot( aes(x = factor(Edad, levels = unique(Edad)), y = brecha_paro)) +
  geom_col(fill = "steelblue") +
 ylim(rango_y) +
  labs(title = paste("Brecha de paro por grupo de edad -", año),x = "Grupo de edad",y = "Brecha ") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45,hjust = 1) )+
    geom_hline(yintercept = mean(brecha_edades$brecha_paro[brecha_edades$Periodo == año]),
               color = "grey10", linetype = "dashed", linewidth = 1) 
})

grafico_brecha_paro_por_año

```
Los gráficos resultantes muestran, de forma clara y comparativa, cómo la intensidad de la brecha de género en el desempleo varía según la edad y el momento temporal. En los primeros años analizados, la brecha es especialmente elevada entre los jóvenes, lo que evidencia una mayor vulnerabilidad del empleo femenino en los primeros tramos de edad. En cambio, en los años más recientes para esos tramos de edad, las diferencias tienden a moderarse y presentan un patrón más equilibrado entre grupos, aunque persisten desigualdades estructurales en los segmentos intermedios y de mayor edad.

En conjunto, este bloque  busca ofrecer una visión desagregada y evolutiva de la brecha de paro por edad. Gracias a la representación mediante diagramas de barras, se facilita la comparación entre grupos generacionales y se identifican con claridad los grupos que más contribuyen a mantener las disparidades laborales entre hombres y mujeres a lo largo del tiempo.


En el siguiente bloque de código se genera una animación que muestra la evolución de la brecha de paro por grupo de edad a lo largo del tiempo, mediante transition_states() y ease_aes(), se define la animación temporal por años, que se renderiza y guarda como un archivo GIF utilizando las funciones animate() y anim_save().
```{r}
library(ggplot2)
library(gganimate)
library(dplyr)
library(gifski)

# Media por año
medias_anio <- brecha_edades %>%
  group_by(Periodo) %>%
  summarise(media = mean(brecha_paro, na.rm = TRUE))

# Gráfico
grafico_animado <- ggplot(brecha_edades,
                          aes(x = factor(Edad, levels = unique(Edad)),
                              y = brecha_paro)) +
  geom_col(aes(fill = "Brecha de paro")) +   
  geom_hline(data = medias_anio,
             aes(yintercept = media, color = "Media anual"),   
             linetype = "dashed", linewidth = 1) +
  scale_fill_manual(name="Relleno", values = c("Brecha de paro" = "steelblue")) +
  scale_color_manual( name="Linea",values = c("Media anual" = "black")) +
  labs(
    title = "Brecha de paro por grupo de edad — Año: {closest_state}",
    x = "Grupo de edad",
    y = "Brecha"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.title = element_text(face = "bold"),
        legend.position = "top") +
  transition_states(Periodo, transition_length = 2, state_length = 1) +
  ease_aes("linear")

# Animar
animacion <- animate(
  grafico_animado,
  nframes = length(unique(brecha_edades$Periodo)) * 10,
  fps = 10,
  renderer = gifski_renderer(),
  width = 800,
  height = 600
)

anim_save("brecha_paro.gif", animation = animacion)


browseURL("brecha_paro.gif")
```







# Distribución de la población en el mercado laboral

## Composición del mercado laboral 

En este bloque de código se genera un gráfico exploratorio con el propósito de comprobar la visualización de la composición del mercado laboral antes de automatizar el proceso para todos los años. Para ello, se filtran los datos del año 2024 y se seleccionan las variables relevantes relacionadas con el estado laboral (*Activos, Ocupados, Parados e Inactivos*), junto con la edad y el sexo. Posteriormente, mediante la función `pivot_longer()`, se reorganiza la tabla a formato largo, lo que permite representar las distintas categorías laborales como valores dentro de una misma variable (*Estado*), facilitando así la creación de un gráfico apilado en *ggplot2*.

El gráfico resultante muestra la distribución proporcional de la población según su situación laboral y grupo de edad, diferenciando entre hombres y mujeres mediante `facet_wrap(~Sexo)`. Se emplea `geom_col(position = "fill")` para que las barras representen proporciones y no valores absolutos, y se aplican ajustes estéticos para mejorar la legibilidad, como la rotación de etiquetas del eje X y el uso de `theme_minimal()`. Este gráfico sirvió como prueba inicial para evaluar la claridad y estructura de la visualización antes de desarrollar la función que posteriormente generó automáticamente el mismo tipo de gráfico para todos los años del periodo analizado.

```{r}
datos_composicion_2024<- datos %>% 
  filter(Periodo==2024) %>% 
  select(Periodo,Edad,Sexo,Activos,Ocupados,Parados,Inactivos) %>% 
  pivot_longer(cols = c(Inactivos,Ocupados,Parados),names_to = "Estado",values_to = "N_Personas")
  
datos_composicion_2024 %>%
  ggplot(aes(x = Edad, y = N_Personas, fill = Estado)) +
  geom_col(position = "fill") +
  labs(
    title = "Composición del mercado laboral por grupo de edad en 2024",
    x = "Grupo de edad",
    y = "Proporción",
    fill = "Estado"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  facet_wrap(~Sexo)
```
Tras la comprobación inicial con los datos de 2024, se elaboró este bloque de código para automatizar la generación del mismo tipo de gráfico para todos los años del conjunto de datos. Para ello, se utiliza la función `lapply()`, que aplica el mismo procedimiento de visualización a cada año contenido en la variable `años`. Dentro de la función, los datos se filtran por periodo y se representa la composición del mercado laboral mediante `geom_col(position = "fill")`, mostrando la proporción de cada estado laboral (ocupados, parados e inactivos) dentro de cada grupo de edad.

El código utiliza `facet_wrap(~Sexo)` para mostrar en paneles separados la información correspondiente a hombres y mujeres. El título de cada gráfico se personaliza dinámicamente con el año correspondiente mediante `paste()`. Este procedimiento permitió obtener una serie de gráficos anuales, facilitando así el análisis comparativo de la evolución de la estructura del mercado laboral a lo largo del tiempo y entre sexos.

```{r}

datos_composicion<- datos  %>% 
  select(Periodo,Edad,Sexo,Activos,Ocupados,Parados,Inactivos) %>% 
  pivot_longer(cols = c(Inactivos,Ocupados,Parados),names_to = "Estado",values_to = "N_Personas")

años<- unique(datos_composicion$Periodo)

graficos_composicion_por_año <- lapply(años, function(año) {
  datos_composicion %>%
    filter(Periodo == año) %>%
    ggplot(aes(x =factor(Edad, levels = unique(Edad)), y = N_Personas, fill = Estado)) +
    geom_col(position = "fill") +
    labs(
      title = paste("Composición del mercado laboral por grupo de edad -", año),
      x = "Grupo de edad",
      y = "Proporción",
      fill = "Estado"
    ) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))+
    facet_wrap(~Sexo)#Añadir o quitar según queramos comparar hombres y mujeres o no 
})

graficos_composicion_por_año
```

Del análisis de los gráficos se observa una estructura bastante estable del mercado laboral por edad y sexo a lo largo del tiempo, con ligeras variaciones asociadas a los ciclos económicos. En ambos sexos, el grupo central de edad (30-54 años) concentra la mayor proporción de personas ocupadas, mientras que los extremos —jóvenes y mayores— presentan una mayor presencia de inactivos. Las mujeres muestran sistemáticamente una menor proporción de ocupación y una mayor de inactividad en comparación con los hombres, aunque esta diferencia tiende a reducirse en los años más recientes. Asimismo, la proporción de personas paradas es más significativa en los grupos jóvenes, reflejando una mayor vulnerabilidad del empleo juvenil. En conjunto, los gráficos ponen de manifiesto que, pese a los avances en participación femenina y la estabilidad general del empleo en edades medias, persisten desigualdades de género e importantes diferencias intergeneracionales dentro del mercado laboral.

En este bloque de código se genera una animación en formato GIF que muestra la evolución de la composición del mercado laboral por grupo de edad y sexo a lo largo del tiempo. Siguiendo el mismo procedimiento utilizado en el ejercicio anterior, se crea primero el gráfico base con ggplot2 y posteriormente se aplica la función `animate()` del paquete gganimate, especificando el número de fotogramas y la velocidad de transición. Finalmente, la animación se guarda mediante `anim_save()` como un archivo GIF titulado “composicion_mercado.gif”.
```{r}
library(gifski)
graph1 <- ggplot(datos_composicion, 
                 aes(x = factor(Edad, levels = unique(Edad)),
                     y = N_Personas, fill = Estado)) +
  geom_col(position = "fill") +
  facet_wrap(~Sexo) +
  labs(
    title = "Composición del mercado laboral por grupo de edad - Año: {frame_time}",
    x = "Grupo de edad",
    y = "Proporción",
    fill = "Estado"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  transition_time(Periodo) +
  ease_aes('linear')
animacion <- animate(graph1, nframes = 100, fps = 10, renderer = gifski_renderer())
anim_save("composicion_mercado.gif", animation = animacion)
```
##Proporción de parados
En este bloque de código se genera una serie de gráficos que representan la distribución del paro dentro de cada sexo por grupo de edad y año. Para ello, se utiliza una estructura, que permite crear automáticamente un gráfico por cada año disponible en el conjunto de datos. Primero, los datos se filtran por periodo y se agrupan por sexo y año, tras lo cual se calcula la proporción que representa cada grupo de edad dentro del total de personas paradas del mismo sexo (`Parados / sum(Parados)`).

A continuación, se construyen los gráficos con ggplot2, empleando `geom_col(position = "dodge")` para comparar visualmente la distribución entre hombres y mujeres dentro de cada grupo de edad. El objetivo de este análisis es observar cómo se reparte el desempleo dentro de cada sexo a lo largo del tiempo, identificando posibles diferencias estructurales entre hombres y mujeres en función de la edad. De esta manera, se obtiene una visión más detallada del peso relativo de cada grupo de edad en el total de personas paradas de cada sexo y su evolución temporal.


```{r}
graficos_parados_proporcion_por_año<- lapply(años, function(año){
datos %>%
  filter(Periodo==año) %>% 
  group_by(Sexo, Periodo) %>%
  mutate(Proporcion_parados_en_sexo = Parados / sum(Parados)) %>%
  ungroup() %>%
  ggplot(aes(x = factor(Edad, levels = unique(Edad)), y = Proporcion_parados_en_sexo, fill = Sexo)) +
  geom_col(position = "dodge") +
  labs(
    title = paste("Distribución del paro dentro de cada sexo -",año),
    x = "Grupo de edad",
    y = "Proporción del total de parados del mismo sexo",
    fill = "Sexo"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
})

graficos_parados_proporcion_por_año
```
En estas gráficas se aprecia cómo la distribución del paro dentro de cada sexo ha cambiado en los últimos años, influida por transformaciones estructurales del mercado laboral y demográficas. La elevación progresiva de la edad de jubilación y el retraso en la salida definitiva del mercado laboral han provocado un aumento en la proporción de personas activas en edades más avanzadas, lo que se traduce también en una mayor representación del paro entre los grupos de 55 años o más. Esto indica que el desempleo ya no es un fenómeno concentrado exclusivamente en edades intermedias, sino que se extiende también hacia los trabajadores de mayor edad, quienes permanecen más tiempo en el mercado laboral. Por el contrario, los grupos más jóvenes (de 16 a 24 años) han reducido su presencia relativa en el total de personas desempleadas, debido principalmente a una incorporación más tardía al mercado laboral como resultado del alargamiento de la etapa educativa y del aumento de la formación superior.

En cuanto al análisis por género, se observa que la distribución del paro dentro de cada sexo mantiene ciertas similitudes, pero también muestra matices importantes. En los grupos de edad intermedia (25-54 años), las mujeres tienden a concentrar una mayor proporción del desempleo dentro de su propio sexo, lo que refleja una persistente desigualdad estructural en el acceso y la estabilidad del empleo femenino, especialmente en etapas donde la conciliación familiar y laboral juega un papel determinante. Sin embargo, entre los hombres, el paro se distribuye de forma algo más homogénea entre los distintos grupos de edad, con un incremento más visible en las edades avanzadas, vinculado al impacto de los sectores más cíclicos (como la construcción o la industria) y a la dificultad de reinserción laboral tras la pérdida del empleo.

En conjunto, estas gráficas ponen de manifiesto un proceso de envejecimiento del desempleo y una convergencia progresiva entre hombres y mujeres en la estructura interna del paro, aunque todavía persisten diferencias derivadas de los roles laborales y sociales tradicionales. Mientras los hombres mayores ganan peso dentro del paro total por el retraso en la jubilación, las mujeres siguen mostrando una mayor vulnerabilidad en las edades centrales, reflejando las desigualdades de género que aún caracterizan el mercado laboral español.

En este bloque de código se genera la animación que muestra la evolución de la distribución del paro por sexo y grupo de edad a lo largo de los años. Para ello, primero se calcula la proporción de personas paradas dentro de cada sexo y grupo de edad en cada año, lo que permite comparar la estructura interna del desempleo entre hombres y mujeres. Posteriormente, se aplica una transformación adicional sobre la variable Edad utilizando expresiones regulares. En concreto, se extraen los valores numéricos iniciales de cada etiqueta de edad (por ejemplo, “16”, “20”, “25”, etc.) y se ordenan de forma ascendente. De este modo, se eliminan los caracteres no numéricos y se corrige el problema del grupo “70 y más años”, que antes aparecía desordenado en el eje. Finalmente, con los datos ordenados, se utiliza el paquete gganimate para representar año a año cómo varía la composición del desempleo entre hombres y mujeres, generando un GIF dinámico que facilita la interpretación temporal del fenómeno.

```{r}
library(ggplot2)
library(gganimate)
library(dplyr)
library(gifski)
library(stringr)

datos_anim <- datos %>%
  group_by(Sexo, Periodo, Edad) %>%
  summarise(Parados = sum(Parados, na.rm = TRUE)) %>%
  group_by(Sexo, Periodo) %>%
  mutate(Proporcion_parados_en_sexo = Parados / sum(Parados)) %>%
  ungroup()

edades_orden <- datos_anim %>%
  distinct(Edad) %>%
  mutate(inicio = as.integer(str_extract(Edad, "\\d+"))) %>%  
  arrange(inicio) %>%
  pull(Edad)

datos_anim <- datos_anim %>%
  mutate(Edad = factor(Edad, levels = edades_orden))

grafico_animado <- ggplot(datos_anim, 
                          aes(x = Edad, 
                              y = Proporcion_parados_en_sexo, 
                              fill = Sexo)) +
  geom_col(position = "dodge") +
  labs(
    title = "Distribución del paro dentro de cada sexo - Año: {frame_time}",
    x = "Grupo de edad",
    y = "Proporción del total de parados del mismo sexo",
    fill = "Sexo"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  transition_time(Periodo) +
  ease_aes("linear")

animacion <- animate(
  grafico_animado,
  nframes = length(unique(datos_anim$Periodo)) * 10,  
  fps = 10,
  width = 800,
  height = 600,
  renderer = gifski_renderer()
)
anim_save("distribucion_paro_sexo.gif", animation = animacion)

browseURL("distribucion_paro_sexo.gif")

```











# Resultados



# Conclusión

# -------------------------- JOE ................
## GRAFICAS JOE


IMPORTAMOS EL ARCHIVO CSV

```{r}
library(readr)
df_clean <- read_csv("data/df_clean.csv")

```

Aggrupación de datos por periodo y por sexo
```{r}
# Calculamos la media de la tasa de actividad para cada grupo
# Usamos na.rm = TRUE para ignorar valores faltantes
library(tidyverse)

df_p_sexo <- df_clean %>% group_by(Periodo, Sexo) %>% summarise(tasa_actividad = mean(Tasa_actividad, na.rm = TRUE) #Hay que ignorar los valores NA
                                                                , .groups = "drop") #hay que eliminar esas agrupaciones 

#Que pretendemos? Calcular la media de la tasa de actividad de todos los grupos del df



```

```{r}
# Gráfica 
library(ggplot2)
ggplot(df_p_sexo, aes(x = Periodo, y = tasa_actividad, color = Sexo)) + geom_line(linewidth = 2) +  labs(title = "Tasa de actividad según sexo (2006–2024)", x = "Año", y = "% Tasa de actividad",color = "Sexo") + theme_minimal()  

# Eje X:Periodo -  Eje Y: tasa de actividad promedio


```


```{r}
cat("La gráfica enseña la evolución de la tasa de actividad en España entre los años 2006 y 2024, diferenciada por sexo. Por un lado, la proporción de hombres es mucho mayor a la de mujeres, cosa que va ligada a que los hombres siempre han tenido mayor participicaion en muchos mas sectores, como lo puede ser la construcción, y a que las mujeres se ligan mas al cuidado familiar.
    Pese a esto, la actividad masculina en 2008 se desacelera economicamnete, esto provocado por la crisis financiera que se vivió en la epoca. Es en 2017/18 que comienza su recuperación, pero nunca a los niveles previos a la crisis. En 2020, debido al Covid-19, se observa otra caida en la tendencía (porque el Covid-19 afectó a muchos sectores, como la industría por ejemplo). Aunque se observa también su recuperació, tampoco volvió a los nieveles previos de la crisis de 2008
    por el otro lado, la tasa de actividad femenina se muestra, en el periodo, ascendente ya que han ido incorporandose cada vez mas en el mercado laboral español.\n")
```




Tasa de actividad por edad y sexo

```{r}
# Agrupamos por Periodo, sexo y Edad

##Que pretendemos? Calcular la media de la tasa de actividad para cada combinación
df_sexo_edad <- df_clean %>% group_by(Periodo, Sexo, Edad) %>% summarise(tasa_actividad = mean(Tasa_actividad, na.rm = TRUE),.groups = "drop")

```

```{r}

ggplot(df_sexo_edad, aes(x = Periodo, y = tasa_actividad, color = Edad)) + geom_line(linewidth = 1) +  facet_wrap(~Sexo) + scale_x_continuous(breaks = seq(2006, 2024, by = 2)) + scale_y_continuous(labels = scales::comma) +  labs(title = "Tasa de actividad por edad y sexo (2006–2024)", x = "Año", y = "Tasa de actividad (%)", color = "Edad") + theme_minimal()  + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 10))

```

```{r}
df_mujeres <- df_sexo_edad %>% filter(Sexo == "Mujeres")

ggplot(df_mujeres, aes(x = Periodo, y = tasa_actividad, color = Edad)) +
  geom_line(linewidth = 1) +
  scale_x_continuous(breaks = seq(2006, 2024, by = 2)) +
  scale_y_continuous(labels = scales::comma) +
  labs(
    title = "Tasa de actividad por edad – Mujeres (2006–2024)",
    x = "Año",
    y = "Tasa de actividad (%)",
    color = "Edad"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 10))

```

```{r}
df_hombres <- df_sexo_edad %>% filter(Sexo == "Hombres")

ggplot(df_hombres, aes(x = Periodo, y = tasa_actividad, color = Edad)) +
  geom_line(linewidth = 1) +
  scale_x_continuous(breaks = seq(2006, 2024, by = 2)) +
  scale_y_continuous(labels = scales::comma) +
  labs(
    title = "Tasa de actividad por edad – Hombres (2006–2024)",
    x = "Año",
    y = "Tasa de actividad (%)",
    color = "Edad"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 10))
```





TASA DE PARO POR SEXO
```{r}
df_paro_sexo <- df_clean %>% group_by(Periodo, Sexo) %>% summarise(tasa_paro = mean(Tasa_paro, na.rm = TRUE), .groups = "drop")

ggplot(df_paro_sexo, aes(x = Periodo, y = tasa_paro, color = Sexo)) + geom_line(size=2) + scale_x_continuous(breaks = seq(2006, 2024, by = 2))+ labs(title = "Tasa de paro por sexo (2006–2024)", x = "Año", y = "Tasa de paro (%)") + theme_minimal()

```


Distribución de ocupados e inactivos por sexo

```{r}
df_ocup_inact <- df_clean %>%
  group_by(Sexo) %>%
  summarise(
    Ocupados = sum(Ocupados, na.rm = TRUE),
    Inactivos = sum(Inactivos, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = c(Ocupados, Inactivos), names_to = "Situacion", values_to = "Personas")


```

```{r}
ggplot(df_ocup_inact, aes(x = Sexo, y = Personas, fill = Situacion)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Distribución de ocupados e inactivos por sexo", x = "Sexo", y = "Personas")
```
#gif ocupados-inactivos
```{r}
library(ggplot2)
library(gganimate)
library(gifski)
library(dplyr)
library(tidyr)

# datos por año
df_ocup_inact <- df_clean %>%
  group_by(Periodo, Sexo) %>%
  summarise(
    Ocupados = sum(Ocupados, na.rm = TRUE),
    Inactivos = sum(Inactivos, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  pivot_longer(cols = c(Ocupados, Inactivos), names_to = "Situacion", values_to = "Personas")

# gráfico animado
graph1 <- ggplot(df_ocup_inact, aes(x = Sexo, y = Personas, fill = Situacion)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    title = "Distribución de ocupados e inactivos por sexo – Año: {frame_time}",
    x = "Sexo",
    y = "Personas",
    fill = "Situación"
  ) +
  theme_minimal() +
  transition_time(Periodo) +
  ease_aes('linear')

#  GIF 
anim_save("ocupados_inactivos_sexo.gif", animation = graph1, renderer = gifski_renderer())

```







```{r}
df_act_inact <- df_clean %>%
  group_by(Sexo) %>%
  summarise(
    Activos = sum(Activos, na.rm = TRUE),
    Inactivos = sum(Inactivos, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = c(Activos, Inactivos), names_to = "Situacion", values_to = "Personas")

ggplot(df_act_inact, aes(x = Sexo, y = Personas, fill = Situacion)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    title = "Distribución de activos e inactivos por sexo",
    x = "Sexo",
    y = "Personas",
    fill = "Situación"
  ) +
  theme_minimal()

``` 


```{r}
library(ggplot2)
library(gganimate)
library(gifski)
library(dplyr)
library(tidyr)

# 1️⃣ Preparar los datos por año
df_act_inact <- df_clean %>%
  group_by(Periodo, Sexo) %>%
  summarise(
    Activos = sum(Activos, na.rm = TRUE),
    Inactivos = sum(Inactivos, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  pivot_longer(cols = c(Activos, Inactivos), names_to = "Situacion", values_to = "Personas")

# 2️⃣ Crear el gráfico animado
graph1 <- ggplot(df_act_inact, 
                 aes(x = Sexo, y = Personas, fill = Situacion)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    title = "Distribución de activos e inactivos por sexo – Año: {frame_time}",
    x = "Sexo",
    y = "Personas",
    fill = "Situación"
  ) +
  theme_minimal() +
  transition_time(Periodo) +
  ease_aes('linear')

# 3️⃣ Crear la animación desde el gráfico
animacion <- animate(graph1, nframes = 100, fps = 10, renderer = gifski_renderer())

# 4️⃣ Guardar el GIF
anim_save("activos_inactivos_sexo.gif", animation = animacion, renderer = gifski_renderer())




```








graf vilin
```{r}
library(dplyr)
library(tidyr)
library(ggplot2)


ggplot(df_clean, aes(x = Edad, y = Parados, fill = Sexo)) +
  geom_violin(trim = FALSE, scale = "width") +
  labs(
    title = "Distribución del paro por edad y sexo",
    x = "Rango de edad",
    y = "Número de parados",
    fill = "Sexo"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("Hombres" = "red", "Mujeres" = "blue")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))



```

```{r}
library(dplyr)
library(ggplot2)

# Preparar los datos: convertir Edad a factor con orden lógico
df_clean <- df_clean %>%
  mutate(Edad = factor(Edad, levels = unique(Edad)))

# Crear gráfico de violín
ggplot(df_clean, aes(x = Edad, y = Parados, fill = Sexo)) +
  geom_violin(trim = FALSE, scale = "width") +
  labs(
    title = "Distribución del paro por edad y sexo",
    x = "Rango de edad",
    y = "Número de parados",
    fill = "Sexo"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("Hombres" = "blue", "Mujeres" = "green")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```




Estadisiticas

# desv est y varianza
```{r}
df_clean %>% group_by(Sexo) %>% summarise(sd_ocupados = sd(Ocupados, na.rm = TRUE),var_ocupados = var(Ocupados, na.rm = TRUE))

```




```{r}
df_clean %>%
  group_by(Sexo) %>%
  summarise(media_ocupados = mean(Ocupados, na.rm = TRUE),
            media_inactivos = mean(Inactivos, na.rm = TRUE)) %>%
  summarise(brecha_ocup = diff(media_ocupados),
            brecha_inact = diff(media_inactivos))

```






```{r}
df_brecha_genero <- df_clean %>% group_by(Periodo, Sexo) %>% summarise(tasa = mean(Tasa_actividad, na.rm = TRUE), .groups = "drop") %>% pivot_wider(names_from = Sexo, values_from = tasa) %>% mutate(Brecha = Hombres - Mujeres)

df_brecha_genero

```

```{r}
ggplot(df_brecha_genero, aes(x = Periodo, y = Brecha)) +
  geom_line(color = "red", linewidth = 2) +
  geom_smooth(method = "lm", se = FALSE, linetype = "dashed") + scale_y_continuous(breaks = seq(0, 20, by = 2))+
  labs(title = "Evolución de la brecha de género en la tasa de actividad",
       x = "Año", y = "Diferencia (Hombres - Mujeres)")

```



```{r}
ggplot(df_brecha_genero, aes(x = Periodo, y = Brecha)) +
  geom_point(color = "red") +
  geom_smooth(method = "loess", se = FALSE, color = "blue", linewidth = 1.2) + scale_y_continuous(breaks = seq(0, 20, by = 2))+ scale_x_continuous(breaks = seq(2006, 2024, by = 2)) +
  labs(
    title = "Interpolación de la brecha de género NO LINEAL",
    x = "Año",
    y = "Brecha (Hombres - Mujeres)"
  ) +
  theme_minimal()

```



hombres/mujeres
```{r}
brecha_relativa <- df_clean %>%
  group_by(Periodo, Sexo) %>%
  summarise(Tasa = mean(Tasa_actividad, na.rm = TRUE), .groups = "drop") %>%
  pivot_wider(names_from = Sexo, values_from = Tasa) %>%
  mutate(Razon = Hombres / Mujeres)

brecha_relativa
#j
#l

```

```{r}
ggplot(brecha_relativa, aes(x = Periodo, y = Razon)) +
  geom_line(color = "blue", linewidth = 1.2) +
  geom_point(color = "red", size = 2) +
  geom_hline(yintercept = 1, linetype = "dashed", color = "gray") +  # línea de igualdad
  scale_y_continuous(breaks = seq(1, 1.5, by = 0.05)) +  # marcas cada 0.05
  scale_x_continuous(breaks = seq(2006, 2024, by = 2)) +  # años cada 2
  labs(
    title = "Evolución de la razón Hombres/Mujeres",
    x = "Año",
    y = "Razón (Hombres / Mujeres)"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(face = "bold")
  )
```



por edad
```{r}
# Filtrar para excluir el grupo de edad "70 y más años"
#brecha_edad_filtrada <- brecha_edad %>% filter(Edad != "70 y más años")

# Graficar la razón Hombres/Mujeres por edad (sin el grupo de 70)
#ggplot(brecha_edad_filtrada, aes(x = Periodo, y = Razon, color = Edad)) +
  geom_line(linewidth = 1) +
  geom_hline(yintercept = 1, linetype = "dashed", color = "gray") +
  scale_y_continuous(breaks = seq(0.5, 2, by = 0.1)) +
  scale_x_continuous(breaks = seq(2006, 2024, by = 2)) +
  labs(
    title = "Razón Hombres/Mujeres en la tasa de actividad por edad (sin 70+)",
    x = "Año",
    y = "Razón (Hombres / Mujeres)",
    color = "Edad"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```











```{r}

df_feminizacion <- df_clean %>%
  group_by(Periodo, Edad, Sexo) %>%
  summarise(Ocupados = sum(Ocupados), .groups = "drop") %>%
  pivot_wider(names_from = Sexo, values_from = Ocupados) %>%
  mutate(Indice_feminizacion = Mujeres / (Hombres + Mujeres) * 100)

df_feminizacion

library(dplyr)
library(tidyr)
library(ggplot2)

ggplot(df_feminizacion, aes(x = Periodo, y = Indice_feminizacion, color = Edad)) +
  geom_line(size = 1.2) +
  labs(
    title = "Índice de feminización en ocupación por edad (2006–2024)",
    x = "Año",
    y = "Porcentaje de mujeres (%)",
    color = "Grupo de edad"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
las mujeres tienen mayor presencia en la ocupación en los grupos de edad entre 30 y 54 años, especialmente desde 2010. 
los jóvenes (16–24 años) y mayores (65+) presentan menor participación femenina y más fluctuaciones.





# ---------------------------------

# --------------------------JOSE-------------






#---------------------------------------------------





```{r,echo = FALSE}
# animacion_actividad <- df_ancho %>%
#   ggplot(aes(x = Edad, y = Tasa_actividad, color = Sexo, group = Edad)) +
#   geom_point(size = 4, alpha = 0.8) +
#   geom_line(aes(group = Edad), alpha = 0.5) +
#   labs(
#     title = "Tasa de Actividad por Edad y Sexo - Año: {as.integer(frame_time)}",
#     subtitle = "La brecha de género en la participación laboral.",
#     y = "Tasa de Actividad (%)",
#     x= "Edad (años)"
#   ) +
#   theme_minimal() +
#   transition_time(Periodo) +
#   ease_aes('linear')
# anim_save(
#   filename = "evolucion_actividad.gif", 
#   animation = animacion_actividad,
#   renderer = gifski_renderer(loop = TRUE)
# )
```



```{r,echo = FALSE}
ggplot(df_clean, aes(x = Sexo, y = Tasa_actividad, fill = Sexo)) +
  geom_boxplot() +
  labs(
    title = "Distribución de la Tasa de Actividad por Sexo (Análisis Global)",
    subtitle = "El boxplot visualiza la mediana, la dispersión y la asimetría de la brecha.",
    y = "Tasa de Actividad (%)",
    x = NULL
  )  +
  theme_minimal()
```


```{r,echo = FALSE}
edades_focales <- c(
  "25-29",
  "30-34",
  "35-39",
  "40-44",
  "45-49",
  "50-54"
)
t.test(Tasa_ocupacion ~ Sexo, data = df_clean%>% filter(Periodo == 2024,Edad%in%edades_focales))
```



